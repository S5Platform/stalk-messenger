#!/usr/bin/env node

const fs = require('fs');

const packageData = fs.readFileSync('../package.json', 'utf8');
const jsonData = JSON.parse(packageData).dependencies;
console.log(jsonData);

var output = {
  comment: "This file was auto-generated by the shell script, /scripts/licences.",
  licenses: []
};

Object.keys(jsonData).map(name => {

  const moduleFile = fs.readFileSync(`../node_modules/${name}/package.json`, 'utf8');
  const json = JSON.parse(moduleFile);

  output.licenses.push({
    name: name,
    homepage: json.homepage.replace('#readme', ''),
    version: json.version,
    type: json.license,
  })

})

fs.writeFileSync('../assets/license.json', JSON.stringify(output, null, 2), 'utf8')
